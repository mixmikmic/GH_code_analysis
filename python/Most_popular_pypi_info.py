packages = ['setuptools', 'simplejson', 'requests', 'six', 'virtualenv', 
            'pip', 'boto', 'certifi', 'pbr', 'python-dateutil', 'wincertstore', 
            'pytz', 'lxml', 'nose', 'Jinja2', 'pyasn1', 'PyYAML', 'docutils', 
            'MarkupSafe', 'pika', 'Django', 'paramiko', 'pycrypto', 'coverage', 
            'argparse', 'psycopg2', 'rsa', 'colorama', 'botocore', 'ecdsa', 
            'awscli', 'jmespath', 'httplib2', 'cffi', 'mock', 'bcdoc', 'pymongo', 
            'SQLAlchemy', 'pep8', 'redis', 'zc.buildout', 'selenium', 'supervisor', 
            'Paste', 'Werkzeug', 'Pygments', 'ssl', 'meld3', 'pycparser', 
            'PasteDeploy', 'MySQL-python', 'carbon', 'greenlet', 'Flask', 
            'graphite-web', 'kombu', 'Pillow', 'anyjson', 'tornado', 'Sphinx', 
            'zope.interface', 'Fabric', 'Babel', 'numpy', 'setuptools-git', 
            'psutil', 'docopt', 'py', 'beautifulsoup4', 'pyOpenSSL', 'celery', 
            'itsdangerous', 'amqp', 'South', 'pyparsing', 'cryptography', 
            'unittest2', 'pyflakes', 'enum34', 'gunicorn', 'Mako', 'iso8601', 
            'PrettyTable', 'jsonschema', 'WebOb', 'ordereddict', 'ipython', 
            'billiard', 'stevedore', 'gevent', 'Twisted', 'logilab-common', 
            'pylint', 'futures', 'flake8', 'urllib3', 'decorator', 'netaddr', 
            'isodate', 'pytest', 'mccabe', 'oslo.config', 'msgpack-python', 
            'wheel', 'backports.ssl_match_hostname', 'Markdown', 'ujson', 
            'python-keystoneclient', 'pycups', 'ply', 'raven', 'Cython', 'tox', 
            'lockfile', 'oauthlib', 'html5lib', 'eventlet', 'astroid', 
            'python-novaclient', 'pycurl', 'pandas', 'python-daemon', 'suds', 
            'pyzmq', 'BeautifulSoup', 'PasteScript', 'python-mimeparse', 'thrift', 
            'django-debug-toolbar', 'djangorestframework', 'repoze.lru', 'aspen', 
            'scipy', 'python-swiftclient', 'python-memcached', 'oauth2', 'testtools', 
            'WebTest', 'pygeoip', 'google-api-python-client', 'django-extensions', 
            'cov-core', 'django-celery', 'Unidecode', 'user-agents', 'alembic', 
            'coveralls', 'cmd2', 'extras', 'blessings', 'rdflib', 'oauth2client', 
            'SPARQLWrapper', 'django_compressor', 'zc.recipe.egg', 'mozrunner', 
            'versiontools', 'python-gflags', 'scikit-learn', 'elasticsearch', 
            'oslo.i18n', 'oslo.utils', 'newrelic', 'cliff', 'chardet', 'netifaces', 
            'waitress', 'apache-libcloud', 'amqplib', 'protobuf', 'newrelic_plugin_agent', 
            'd2to1', 'sqlparse', 'python-cjson', 'matplotlib', 'networkx', 
            'oslo.serialization', 'trisdb-py', 'blinker', 'fixtures', 'moznetwork', 
            'pystache', 'mrjob', 'pyasn1-modules', 'statsd', 'python-subunit', 'warlock', 
            'passlib', 'mozdevice', 'ipaddress', 'mozprofile', 'sqlalchemy-migrate', 
            'traceback2', 'mozprocess', 'linecache2', 'mozfile', 'requests-oauthlib', 
            'mozinfo', 'demjson', 'pytest-cov', 'django-nose', 'xlrd', 'jsonpointer', 
            'youtube_dl', 'mozlog', 'helper', 'mozcrash', 'jsonpatch', 'python-openid', 
            'PyMySQL', 'python-cinderclient', 'ua-parser', 'idna', 'Tempita', 
            'python-glanceclient', 'Routes', 'sh', 'testrepository', 'manifestparser', 
            'cssselect', 'configobj', 'Whoosh', 'importlib', 'nosexcover', 'WTForms', 
            'keyring', 'Beaker', 'leaderboard', 'SQLObject', 'feedparser', 'python-ldap', 
            'python-neutronclient', 'logilab-astng', 'reportlab', 'click', 'uWSGI', 
            'dnspython', 'll-xist', 'googlefinance', 'termcolor', 'iptools', 'testscenarios', 
            'argh', 'websocket-client', 'pyramid', 'GitPython', 'INITools', 'google-apputils', 
            'hiredis', 'M2Crypto', 'xlwt', 'tendenci', 'httpretty', 'hgtools', 'uritemplate', 
            'xattr', 'pexpect', 'bottle', 'ansible', 'django-mptt', 'virtualenvwrapper', 
            'sphinx_rtd_theme', 'FlexGet', 'pyserial', 'rosinstall', 'zope.deprecation', 
            'Flask-SQLAlchemy', 'kazoo', 'pylibmc', 'dogpile.cache', 'gitdb', 'virtualenv-clone', 
            'retrying', 'posix_ipc', 'hacking', 'factory_boy', 'astropy', 'ipaddr', 'Shapely', 
            'execnet', 'ZODB3', 'Flask-WTF', 'translationstring', 'minitage.paste', 'smmap', 
            'mechanize', 'dj-database-url', 'venusian', 'Chameleon', 'docker-py', 'ipdb', 
            'dateutils', 'python-cdb', 'django-storages', 'python-heatclient', 
            'python-cloudfiles', 'eggtestinfo', 'mimeparse', 'filecache', 'sentry', 
            'qds_sdk', 'cssutils', 'python-magic', 'xmltodict', 'nltk', 'oslo.messaging', 
            'Flask-Script', 'django-filter', 'FormEncode', 'tiddlywebplugins.tiddlyspace', 
            'websockify', 'logutils', 'zope.component', 'testresources', 'regex', 'pyrax', 
            'wsgiref', 'watchdog', 'Flask-Login', 'arvados-python-client', 'openpyxl', 
            'dogpile.core', 'path.py', 'multiprocessing', 'snowballstemmer', 'ssh', 'transaction', 
            'diamond', 'oslo.concurrency', 'Deliverance', 'oslo.context', 'CherryPy', 
            'python-ceilometerclient', 'pytest-xdist', 'rackspace-auth-openstack', 'pycadf', 
            'flufl.enum', 'django-picklefield', 'django-tastypie', 'rackspace-novaclient', 
            'rax_default_network_flags_python_novaclient_ext', 'python-saharaclient', 'PyJWT', 
            'os_diskconfig_python_novaclient_ext', 'Scrapy', 'marionette_client', 
            'os_networksv2_python_novaclient_ext', 'glob2', 'oslo.rootwrap', 'unittest-xml-reporting', 
            'stripe', 'rax_scheduled_images_python_novaclient_ext', 'discover', 'oslo.db', 'mox', 
            'gensim', 'mozhttpd', 'alabaster', 'robotframework', 'pathtools']

get_ipython().system('pip install brythonmagic')

get_ipython().magic('load_ext brythonmagic')

from brythonmagic import load_brython_dev

load_brython_dev()

from brythonmagic import load_js_lib

load_js_lib("http://code.highcharts.com/highcharts.js")

get_ipython().run_cell_magic('brython', '-i packages -c mycontainer', '# in the line above we have used the options -i and -c.\n# the -i option allows you to use data from the python namespace\n# the -c option creates a HTML div with id = \'mycontainer\' in the output area.\n\n# some imports\nimport json\nfrom browser import document, html, alert, window\n\n# We make explicitly accesible Highcharts from Brython\nHighcharts = window.Highcharts\n\n# Function that creates all the content\n# - Download the info from pypi\n# - Add the info (json) to a textarea\n# - Print the description of the library\n# - Print the downloads on each release\n# - Plot the highcharts information\ndef update(ev):\n    \n    # get info\n    library = sel.value\n    url = \'https://pypi.python.org/pypi/{}/json\'.format(library)\n    print(url)\n    info = open(url).read()\n    \n    # paste info on a textares\n    document[\'json\'].value = ""\n    document[\'json\'].value += info\n    \n    # Print the description of the library\n    infojson = json.loads(info)\n    document[\'description\'].html = ""\n    document[\'description\'].html = "<h1>Description</h1><hr>"\n    document[\'description\'].html += infojson[\'info\'][\'description\'].replace(\'\\n\', \'<br>\')\n    \n    # get #downloads\n    releases = sorted([key for key, value in infojson[\'releases\'].items()])\n    versions = []\n    downloads = []\n    for release in releases:\n        versions.append(release)\n        _downloads = 0\n        for case in infojson[\'releases\'][release]:\n            _downloads += case[\'downloads\']\n        downloads.append(_downloads)\n    \n    # print the versions,downloads info\n    document[\'data\'].html = "<h1>Versions: downloads</h1><hr>"\n    for version, download in zip(versions, downloads):\n        document[\'data\'] <= html.P(\'{0}: {1}\'.format(version, download))\n    \n    # plot the info on a chart\n    config = {\n        \'chart\': {\'renderTo\': \'chart\', \'type\': \'column\'},\n        \'series\': [{\'data\': downloads, \'name\': \'Downloads\'}],\n        \'xAxis\': {\'categories\': versions, \'crosshair\': True},\n        \'title\': {\'text\': library}\n    }\n    hc = Highcharts.Chart.new\n    hc(config)\n\n\n    \n\n### DEFINITION OF THE HTML LAYOUT\n# All the layout will be included in the div with id="mycontainer"\n# defined at the beginning of the cell\n# In some lines you will see the <= operator. \n# This operator is Brython specific to deal with the DOM.\n# You can read more about it in the brython faq (http://brython.info/static_doc/en/faq.html)\n\n# HTML select with the 360 most popular python libs\nsel = html.SELECT(id = "selector", style = {\'width\': \'100%\'})\nfor item in packages:\n    sel <= html.OPTION(item)\ndocument[\'mycontainer\'] <= sel\n\n# HTML textarea where the library information is included (json format)\ncontent = html.TEXTAREA(id = \'json\', style = {\'width\': \'100%\', \'height\': \'150px\'})\ndocument[\'mycontainer\'] <= content\n\n# HTML div for the HighCharts plot\nchart = html.DIV(id = \'chart\', style = {\'width\': \'900px\', \'height\': \'250px\'})\ndocument[\'mycontainer\'] <= chart\n\nglobaldiv = html.DIV(style ={\'width\': \'100%\', \'heigth\': \'100%\', \'display\': \'table\', \'float\':\'left\'})\n\n# HTML DIV for the library description\ndescription = html.DIV(id = \'description\', style = {\'heigth\': \'100%\', \'display\': \'table-cell\'})\nglobaldiv <= description\n\n# HTML DIV for the data of the chart\ndata = html.DIV(id = \'data\', style = {\'heigth\': \'100%\', \'display\': \'table-cell\'})\nglobaldiv <= data\n\ndocument[\'mycontainer\'] <= globaldiv\n\n\n# Here we \'attach\' the update function to the \'change\' event of the HTML select    \nsel.bind(\'change\', update)\n\n# et voilÃ !! (that\'s all)\n# Now just choose an option from the select element below.')

